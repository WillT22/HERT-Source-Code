function [MaxFlux25_90,MinFlux25_90,ApoFlux25_90,MaxFlux50_90,MinFlux50_90,ApoFlux50_90,MaxFlux75_90,MinFlux75_90,ApoFlux75_90,MaxFlux95_90,MinFlux95_90,ApoFlux95_90,MaxFluxMean_90,MinFluxMean_90,ApoFluxMean_90] = FluxRate90(r)
%FluxRate Summary of this function goes here
%   Inputs:
%     X- energy at flux
%     Outputs:
%     Flux50:Expected average flux at energy X
%     Flux75:Expected 75th percentile flux at energy X
%     Flux95:Expected 95th percentile flux at energy X

x = [0.5,0.75,1:0.5:8];

%% Omnidirectional
%Values from AE9
%25th Percentile
MaxFlux25_AE9_90= [1299128.18	159571.67	58982.02	15129.9237	3041.56181	718.45857	219.159343	77.6956967	26.2584103	10.3683737	4.73543853	2.43125066	1.31421209	0.694297103	0.328897155 0.265913281	0.202929408];
MinFlux25_AE9_90= [10912.9057	825.198408	330.449704	169.54976	77.7162659	31.8123459	13.0916374	4.78518407	1.8178498	0.769833692	0.39312206	0.230325859	0.140320451	0.085666892	0.046729895 0.039016494	0.031303092];
ApoFlux25_AE9_90= [127986.22	24967.9964	5444.69973	1319.99226	312.878706	81.8187931	25.3755998	9.72523144	4.90561484	2.21073182	0.957248098	0.416308498	0.239633178	0.152650546	0.07342178 0.057816453 0.042211125];

%50th Percentile
MaxFlux50_AE9_90= [3043556.52	506402.542	211356.954	62748.4502	15499.6257	4167.08963	1362.59182	508.053908	196.611127	82.051654	37.154501	17.4685642	8.97551526	5.28536699	2.81916956 2.33	1.84];
MinFlux50_AE9_90= [87065.4841	9000.52661	3466.00034	1653.26674	737.498429	299.675391	128.223723	51.527098	21.5263988	10.2522321	5.63969532	3.47792809	2.17690499	1.39891194	0.80894955 0.685474789	0.562000028];
ApoFlux50_AE9_90= [341776.994	78702.5833	20845.5994	5693.35574	1472.38512	399.944599	129.090197	49.2612793	23.5157668	10.5373774	4.81524394	2.36038762	1.4794959	1.00421865	0.532351405 0.430483052	0.328614699];

%75th Percentile
MaxFlux75_AE9_90= [5954877.83	1258557.25	590380.762	202629.404	58159.668	16656.5776	5906.61956	2397.14709	991.163556	436.275356	196.258873	94.3908837	49.8709683	30.3881283	16.5763025 13.7416615 10.9904901];
MinFlux75_AE9_90= [430398.486	44763.2346	14269.359	5545.31911	2183.6765	847.127292	380.657981	172.490309	81.783271	44.5794151	27.1835619	18.1506675	12.0351114	8.21203002	5.02883858 4.40881832 3.68674389];
ApoFlux75_AE9_90= [741554.833	194643.441	60101.779	18034.1354	4996.24183	1398.42223	465.736857	177.111453	80.9439822	36.1004976	17.2120895	9.2718457	6.21568293	4.43625712	2.53942722 2.10258632 1.66562056];

%95th Percentile
MaxFlux95_AE9_90= [12559884.1	3917196.38	2094895.39	826481.191	256040.313	79982.653	30444.5749	13671.416	6070.77165	2795.68906	1292.31374	654.009611	366.498171	235.290299	139.450819 119.126969 98.8031184];
MinFlux95_AE9_90= [2404183.7	286581.807	80278.5175	27311.1463	10245.9702	3822.18999	1828.73641	863.673911	425.782876	241.123197	154.292021	105.154032	71.3507142	50.6479176	32.2673942 28.0048072 23.7422203];
ApoFlux95_AE9_90= [1753727.44	532323.177	194919.825	64926.6752	19416.2462	5617.60949	1937.2571	734.009612	319.68837	141.834443	70.8966219	42.4119355	30.6420444	23.1319331	14.4237781 12.2959433 10.1681086];

%Mean
MaxFluxMean_AE9_90= [4284294.4	987847.371	497075.967	190568.703	57386.6082	17693.1617	6656.09705	2948.71527	1302.47442	598.629251	276.547916	140.044867	79.0806048	50.969725	31.2524332 26.982770 22.713108];
MinFluxMean_AE9_90= [527008.793	73069.9886	22619.7347	8348.85954	3293.22885	1285.30395	609.062198	292.793574	146.32749	85.7581843	55.3822419	38.8873404	26.7189551	19.391191	12.6224008 11.0471082 9.47181551];
ApoFluxMean_AE9_90= [543134.812	148679.823	49426.7817	15701.1899	4559.39628	1304.11571	444.805326	168.743676	74.6672731	33.1902862	16.3350572	9.49303049	6.74878269	5.04578025	3.11202649 2.64802017 2.18401386];

%Calculate flux value
% 25th Percetile
 MinFlux25_90 = interp1(x,MinFlux25_AE9_90,r);
 MaxFlux25_90 = interp1(x,MaxFlux25_AE9_90,r);
 ApoFlux25_90 = interp1(x,ApoFlux25_AE9_90,r);

%50th Percetile
MinFlux50_90 = interp1(x,MinFlux50_AE9_90,r);
MaxFlux50_90 = interp1(x,MaxFlux50_AE9_90,r);
ApoFlux50_90 = interp1(x,ApoFlux50_AE9_90,r);

%75th Percetile
 MinFlux75_90 = interp1(x,MinFlux75_AE9_90,r);
MaxFlux75_90 = interp1(x,MaxFlux75_AE9_90,r);
 ApoFlux75_90 = interp1(x,ApoFlux75_AE9_90,r);

%95th Percetile
 MinFlux95_90 = interp1(x,MinFlux95_AE9_90,r);
MaxFlux95_90 = interp1(x,MaxFlux95_AE9_90,r);
 ApoFlux95_90 = interp1(x,ApoFlux95_AE9_90,r);

%Average
 MinFluxMean_90 = interp1(x,MinFluxMean_AE9_90,r);
 MaxFluxMean_90= interp1(x,MaxFluxMean_AE9_90,r);
 ApoFluxMean_90 = interp1(x,ApoFluxMean_AE9_90,r);


%% User created interpol
% if r>= 0.5 && r<= 0.75
%     MinFlux50Omni = -5264851.86*r + 4021596.26;%y = -5,264,851.86x + 4,021,596.26
%     
%     ApoFlux50Omni = -18630863.76*r+ 15952251.27;
%     
%     
%     MaxFlux50Omni = -70332511.16*r + 58073941.28;
%     MaxFlux75Omni = -130533391.20*r + 111367423.10;%y = -130,533,391.20x + 111,367,423.10
%     MaxFlux95Omni = -234642452*r + 218019366;
%     
% elseif r>= 0.75 && r<= 1.0
%     MinFlux50Omni = -221590.29*r + 239150.09; %y = -221,590.29x + 239,150.09
%     
%     ApoFlux50Omni = -5477135.85*r+ 6086955.34;
%     
%     MaxFlux50Omni = -12459253.88*r + 14668998.32;
%     MaxFlux75Omni = -28791595.52*r + 35061076.34;%y = -28,791,595.52x + 35,061,076.34
%     MaxFlux95Omni = -78888027.2*r + 101203547;
%     
% elseif r>= 1.0 && r<= 1.5
%     MinFlux50Omni = -23672.54*r + 41232.33;%y = -23,672.54x + 41,232.33
%     
%     ApoFlux50Omni = -845354.54*r+ 1455174.03;
%     
%     MaxFlux50Omni = -3104268.57*r + 5314013.01;
%     MaxFlux75Omni = -8225808.24*r + 14495289.06;%y = -8,225,808.24x + 14,495,289.06
%     MaxFlux95Omni = -26999680.40*r + 49315200.60;
%     
% elseif r>= 1.5 && r<= 2.0
%     MinFlux50Omni = -7444.22*r + 16889.85;%y = -7,444.22x + 16,889.85
%     
%     ApoFlux50Omni = -270345.05*r+ 592656.79;
%     
%     MaxFlux50Omni = -992812.41*r + 2146828.77;
%     MaxFlux75Omni = -3091070.44*r+ 6796182.35;%y = -3,091,070.44x + 6,793,182.35
%     MaxFlux95Omni = -12185602*r+27094083;
%     
% elseif r>= 2.0 && r<= 2.5
%     MinFlux50Omni = -2656.43*r + 7314.26; %y = -2,656.43x + 7,314.26
%     
%     ApoFlux50Omni = -74030.92*r+ 200031.53;
% 
%     
%     MaxFlux50Omni = -236816.57*r + 634837.08;
%     MaxFlux75Omni = -875112.76*r + 2361266.99;%y = -875,112.76x + 2,361,266.99
%     MaxFlux95Omni = -3757378*r + 10237635;
%     
% elseif r>= 2.5 && r<= 3.0
%     MinFlux50Omni = -810.78*r + 2700.15;%y = -810.78x + 2,700.15
% 
%     ApoFlux50Omni = -20697.8*r+ 66698.73;
%     
%     MaxFlux50Omni = -57669.67*r + 186969.84;
%     MaxFlux75Omni = -224890.53*r + 735711.43;%y = -224,890.53x + 735,711.43
%     MaxFlux95Omni = -1049424.2*r + 3467750.50;
%     
% elseif r>= 3.0 && r<= 3.5
%     MinFlux50Omni = -307.70*r + 1181.91;%y = -304.70x + 1,181.91
% 
%     ApoFlux50Omni = -6149.2*r+ 23052.95;
%     
%     MaxFlux50Omni = -17434.76*r + 66265.12;
%     MaxFlux75Omni = -72402.04*r + 278245.97;%y = -72,402.04x + 278,245.97
%     MaxFlux95Omni = -354126.40*r + 1381857.10;
%     
% elseif r>= 3.5 && r<= 4.0
%     MinFlux50Omni = -125.08*r +553.23;%y = -125.08x + 553.23
% 
%     ApoFlux50Omni = -1870.65*r+ 8078.02;
%     
%     MaxFlux50Omni = -6315.43*r + 27347.45;
%     MaxFlux75Omni = -28900.74*r + 125991.42;%y = -28,900.74x + 125,991.42
%     MaxFlux95Omni = -157786.20*r + 694666.40;
%     
% elseif r>= 4.0 && r<= 4.5
%     MinFlux50Omni = -50.83*r + 256.23;%y = -50.83x + 256.23
% 
%     ApoFlux50Omni = -701.91*r+ 3403.04;
%     
%     MaxFlux50Omni = -2413.47*r + 11739.61;
%     MaxFlux75Omni = -11572.09*r + 56676.81;%y = -11,572.09x + 56,676.81
%     MaxFlux95Omni = -68310.70*r + 336764.40;
%     
% elseif r>= 4.5 && r<= 5.0
%     MinFlux50Omni = -23.13*r + 131.59; %y = -23.13x + 131.59
% 
%     ApoFlux50Omni = -266.24*r+ 1442.54;
%     
%     MaxFlux50Omni = -982.49*r + 5300.21;
%     MaxFlux75Omni = -5118.29*r + 27634.71;%y = -5,118.29x + 27,634.71
%     MaxFlux95Omni = -32040.82*r + 173549.94;
%     
% elseif r>= 5.0 && r<= 5.5
%     MinFlux50Omni = -11.74*r+74.64;%y = -11.74x + 74.64
% 
%     ApoFlux50Omni = -109.93*r+ 660.95;
%     
%     MaxFlux50Omni = -419.40*r + 2484.75;
%     MaxFlux75Omni = -2170.11*r + 12893.83;%y = -2,170.11x + 12,893.83
%     MaxFlux95Omni = -13367.48*r + 80183.26;
%     
% elseif r>= 5.5 && r<= 6.0
%     MinFlux50Omni = -6.77*r + 47.29;%y = -6.77x + 47.29
% 
%     ApoFlux50Omni = -47.9*r+ 319.8;
%     
%     MaxFlux50Omni = -173.75*r + 1133.68;
%     MaxFlux75Omni = -921.19*r + 6024.73;%y = -921.19x + 6,024.73
%     MaxFlux95Omni = -5867.98*r + 38935.98;
%     
% elseif r>= 6.0 && r<= 6.5
%     MinFlux50Omni = -4.07*r + 31.13;%y = -4.07x + 31.13
% 
%     ApoFlux50Omni = -24.12*r+ 177.14;
%     
%     MaxFlux50Omni = -74.75*r + 539.66;
%     MaxFlux75Omni = -385.44*r + 2810.25;%y = -385.44x + 2,810.25
%     MaxFlux95Omni = -2642.26*r + 19581.67;
%     
% elseif r>= 6.5 && r<= 7.0
%     MinFlux50Omni = -3.64*r + 28.31;%y = -3.64x + 28.31
%     
%     ApoFlux50Omni = -19.71*r+ 148.48;
%     
%     MaxFlux50Omni = -51.35*r + 387.59;
%     MaxFlux75Omni = -272.16*r + 2073.91;%y = -272.16x + 2,073.91
%     MaxFlux95Omni = -1929.60*r + 14949.40;
%     
% end



end

